#!/usr/bin/env python3

from ast import Constant
from bleach import clean
import numpy as np
import numpy.fft as fft
from matplotlib import pyplot as plt

r = [91.76, 91.91, 93.27, 185.62, 196.32, 173.76, 162.32, 149.29, 133.78, 120.68, 110.13, 101.6, 95.73, 91.1, 84.72, 79.15, 74.08, 69.07, 65.68, 62.86, 60.47, 56.04, 50.93, 38.22, 23.65, 15.16, 11.22, 2.91, 1.69, 1.21, 1.14, 1.07, 0.91, 0.36, 1.55, 2.38, 3.01, 4.07, 4.52, 4.59, 4.39, 3.66, 3.91, 3.97, 4.42, 4.27, 4.3, 4.01, 4.3, 4.55, 4.88, 4.17, 4.85, 4.83, 5.03, 5.16, 5.15, 4.82, 4.38, 4.23, 4.19, 4.03, 4.65, 4.27, 4.62, 4.37, 4.64, 4.41, 4.36, 4.03, 4.22, 4.28, 4.39, 4.2, 4.54, 4.39, 4.31, 4.38, 4.66, 4.29, 4.35, 4.72, 4.66, 4.22, 4.43, 4.22, 4.32, 4.39, 4.43, 4.26, 4.31, 4.4, 4.79, 4.49, 4.31, 4.27, 4.5, 4.52, 4.53, 4.19, 4.38, 4.27, 4.4, 4.4, 4.5, 4.43, 4.63, 4.18, 4.64, 4.25, 4.55, 4.53, 4.74, 4.39, 4.39, 4.38, 4.06, 4.3, 4.49, 4.59, 4.65, 4.0, 4.19, 4.22, 4.54, 4.32, 4.39, 4.33, 4.36, 4.0, 4.4, 4.24, 4.47, 4.35, 4.35, 4.38, 4.49, 4.28, 4.54, 3.78, 4.59, 4.38, 4.8, 4.66, 4.54, 4.39, 4.5, 4.34, 4.55, 4.3, 4.37, 4.22, 4.45, 4.27, 4.47, 4.37, 4.09, 3.88, 4.57, 4.45, 4.89, 4.39, 4.41, 4.32, 4.49, 4.33, 4.2, 4.26, 4.69, 4.37, 4.63, 4.28, 3.79, 4.19, 4.11, 4.36, 4.43, 4.4, 4.65, 4.34, 4.61, 4.32, 4.54, 4.62, 4.65, 4.4, 4.68, 4.46, 4.3, 4.34, 4.39, 4.12, 4.3, 4.37, 4.52, 4.33, 4.49, 4.39, 4.44, 4.37, 4.45, 4.39, 4.38, 4.29, 4.7, 4.4, 4.45, 4.44, 4.49, 4.42, 4.54, 4.39, 4.41, 4.18, 4.34, 4.3, 4.63, 4.35, 4.12, 4.41, 4.63, 4.19, 4.42, 4.33, 4.6, 4.19, 4.55, 4.32, 4.45, 4.4, 4.55, 4.3, 4.47, 4.22, 4.46, 4.41, 4.37, 4.3, 4.6, 4.35, 4.74, 4.29, 4.5, 4.37, 4.28, 4.23, 4.21, 4.19, 4.78, 4.63, 4.86, 4.67, 4.18, 3.9, 4.11, 3.94, 4.11, 3.92, 4.05, 4.0, 4.09, 3.86, 3.93, 3.74, 4.1, 4.04, 4.5, 4.2, 4.1, 3.91, 3.92, 4.04, 4.18, 4.08, 4.28, 4.24, 4.2, 3.96, 4.06, 3.84, 4.2, 3.99, 4.1, 4.09, 4.6, 4.06, 4.22, 4.0, 4.16, 4.0, 4.08, 4.06, 4.34, 4.06, 4.02, 4.0, 4.03, 4.18, 4.02, 3.82, 4.13, 4.51, 4.78, 4.74, 4.69, 4.03, 4.48, 4.66, 4.69, 4.7, 4.75, 4.74, 4.35, 4.07, 4.68, 4.19, 4.55, 4.25, 4.38, 4.25, 4.28, 4.31, 4.53, 4.3, 4.38, 4.19, 4.47, 4.25, 4.46, 4.51, 4.39, 4.38, 4.44, 4.36, 4.34, 4.2, 4.6, 4.34, 4.58, 4.24, 4.55, 4.33, 4.75, 4.69, 4.57, 4.59, 4.76, 4.45, 4.78, 4.58, 4.25, 4.47, 4.63, 4.51, 4.7, 4.35, 4.54, 4.35, 4.46, 4.17, 4.64, 4.48, 4.6, 4.49, 4.44, 4.31, 4.6, 4.41, 4.57, 4.26, 4.57, 4.39, 4.64, 4.29, 4.44, 4.39, 4.64, 4.6, 4.53, 4.31, 4.63, 4.45, 4.5, 4.34, 4.52, 4.41, 4.44, 4.4, 4.46, 4.41, 4.63, 4.31, 4.43, 4.36, 4.55, 4.31, 4.74, 4.7, 4.45, 4.34, 4.56, 4.4, 4.44, 4.3, 4.46, 4.36, 4.45, 4.44, 4.43, 4.26, 4.6, 4.49, 4.55, 4.33, 4.44, 4.52, 4.53, 4.42, 4.59, 4.38, 4.21, 4.07, 4.43, 3.75, 4.49, 3.84, 4.21, 4.24, 3.82, 3.49, 3.47, 3.52, 3.86, 4.14, 4.46, 4.25, 4.63, 4.47, 4.67, 4.57, 4.68, 4.28, 4.7, 4.47, 4.61, 4.44, 4.73, 4.59, 4.66, 4.59, 4.6, 4.63, 4.7, 4.47, 4.67, 4.32, 4.06, 4.62, 4.82, 4.42, 4.73, 4.21, 4.32, 4.72, 4.89, 4.3, 4.45, 4.41, 4.55, 4.5, 4.66, 3.97, 4.41, 7.61, 114.28, 94.55, 70.12, 55.97, 48.98, 47.56, 45.25, 44.37, 44.41, 46.46, 48.35, 49.12, 51.87, 51.61, 54.18, 59.35, 76.3, 114.24, 128.06, 117.21, 106.32, 94.32, 93.14, 94.49, 96.76, 99.49, 102.31, 104.79, 108.23, 111.96, 117.98, 126.2, 130.93, 134.96, 137.0, 142.97, 147.64, 150.74, 157.34, 163.16, 173.32, 181.7, 180.59, 178.96, 179.63, 176.74, 172.84, 165.6, 161.42, 162.43, 165.66, 167.64, 170.86, 173.52, 176.42, 179.53, 179.93, 182.04, 184.45, 182.71, 184.18, 183.72, 183.42, 183.14, 185.25, 185.67, 185.85, 185.57, 185.37, 185.46, 185.48, 185.57, 185.81, 185.36, 185.34, 185.38, 185.7, 185.64, 185.77, 185.29, 185.51, 185.37, 185.6, 185.5, 185.91, 185.65, 185.91, 185.54, 185.78, 185.61, 185.67, 185.6, 185.62, 185.74, 185.7, 185.65, 185.83, 185.6, 185.68, 185.19, 185.66, 185.49, 185.45, 185.46, 185.51, 185.38, 185.8, 185.58, 185.49, 185.21, 185.69, 185.44, 185.93, 185.59, 185.78, 185.23, 185.82, 185.58, 185.85, 185.53, 185.89, 185.66, 185.72, 185.5, 185.75, 185.49, 185.55, 185.48, 185.82, 185.4, 185.38, 185.35, 185.54, 185.68, 185.58, 185.47, 185.8]
l = [89.02, 88.9, 85.66, 9.19, 22.46, 30.32, 34.77, 40.14, 46.31, 49.82, 49.97, 48.61, 47.01, 45.56, 43.59, 42.79, 38.97, 32.89, 28.16, 26.39, 24.2, 20.26, 17.4, 14.82, 10.03, 14.94, 16.7, 17.24, 15.2, 13.77, 10.39, 7.22, 3.74, 0.85, -2.82, -2.91, -3.34, -3.43, -3.69, -3.63, -5.02, -4.98, -4.7, -4.42, -5.15, -4.53, -4.85, -5.06, -5.22, -5.04, -5.26, -4.74, -5.0, -4.9, -4.99, -4.82, -4.9, -4.93, -4.79, -4.58, -4.74, -4.5, -4.85, -4.61, -4.91, -4.73, -4.87, -4.89, -4.81, -4.84, -4.74, -4.84, -4.79, -4.67, -4.9, -4.65, -4.75, -4.64, -4.96, -4.6, -4.57, -4.6, -4.62, -4.68, -4.73, -4.53, -4.51, -4.53, -4.68, -4.61, -4.86, -4.75, -4.9, -4.64, -4.84, -4.64, -4.94, -4.65, -4.75, -4.69, -4.73, -4.61, -4.82, -4.62, -4.94, -4.66, -4.73, -4.56, -4.89, -4.62, -4.7, -4.62, -4.94, -4.66, -4.85, -4.49, -4.08, -4.72, -4.77, -4.73, -4.71, -4.63, -4.83, -4.53, -4.59, -4.67, -4.77, -4.76, -4.81, -4.57, -4.66, -4.57, -4.95, -4.53, -4.64, -4.78, -4.85, -4.66, -5.01, -4.59, -5.0, -4.76, -5.03, -4.81, -4.97, -4.73, -4.7, -4.66, -4.78, -4.61, -4.84, -4.52, -4.57, -4.8, -4.76, -4.74, -4.67, -4.64, -4.8, -4.76, -4.83, -4.73, -4.81, -4.73, -4.78, -4.64, -4.73, -4.63, -4.65, -4.55, -4.84, -4.63, -4.62, -4.51, -4.78, -4.48, -4.61, -4.56, -4.78, -4.65, -4.97, -4.7, -4.95, -4.57, -4.88, -4.82, -4.85, -4.78, -4.79, -4.68, -4.74, -4.61, -4.74, -4.59, -4.81, -4.46, -4.69, -4.49, -4.71, -4.54, -4.83, -4.5, -4.67, -4.51, -4.75, -4.59, -4.67, -4.5, -4.91, -4.77, -4.75, -4.46, -4.6, -4.42, -4.71, -4.5, -4.56, -4.78, -4.85, -4.46, -4.76, -4.48, -4.91, -4.71, -4.86, -4.63, -4.72, -4.47, -4.85, -4.69, -4.74, -4.68, -4.69, -4.55, -4.85, -4.78, -4.9, -4.68, -4.9, -4.49, -4.85, -4.63, -4.56, -4.53, -4.78, -4.45, -4.76, -4.61, -4.75, -4.52, -4.86, -4.59, -4.8, -4.63, -4.82, -4.74, -4.78, -4.66, -4.8, -4.64, -4.7, -4.4, -4.86, -4.64, -4.72, -4.59, -4.87, -4.61, -4.76, -4.49, -4.84, -4.62, -4.58, -4.59, -4.75, -4.64, -4.68, -4.65, -4.74, -4.64, -4.9, -4.65, -4.68, -4.6, -4.71, -4.7, -4.75, -4.61, -4.64, -4.67, -4.78, -4.63, -4.87, -4.56, -4.64, -4.65, -4.87, -4.58, -4.8, -4.72, -4.84, -4.51, -4.72, -4.51, -4.7, -4.62, -4.77, -4.71, -4.7, -4.63, -4.62, -4.53, -4.67, -4.64, -4.85, -4.75, -4.57, -4.53, -4.62, -4.61, -4.87, -4.67, -4.81, -4.66, -4.75, -4.54, -4.98, -4.63, -4.71, -4.59, -4.81, -4.59, -4.78, -4.58, -4.95, -4.71, -4.93, -4.68, -4.83, -4.73, -4.83, -4.64, -4.84, -4.77, -4.84, -4.63, -4.87, -4.94, -4.93, -4.85, -4.68, -4.58, -4.99, -4.64, -4.86, -4.67, -4.85, -4.63, -4.8, -4.68, -4.89, -4.63, -4.88, -4.72, -5.0, -4.65, -4.81, -4.7, -4.88, -4.67, -4.83, -4.63, -5.01, -4.86, -4.75, -4.82, -4.87, -4.66, -4.91, -4.76, -4.9, -4.73, -4.82, -4.72, -4.87, -4.69, -4.81, -4.59, -4.9, -4.68, -4.74, -4.7, -4.83, -4.65, -4.78, -4.57, -4.74, -4.75, -4.8, -4.74, -4.66, -4.7, -4.7, -4.59, -4.81, -4.7, -4.79, -4.58, -4.8, -4.68, -4.88, -4.68, -4.89, -4.73, -4.92, -4.6, -4.92, -4.67, -4.76, -4.69, -4.72, -4.53, -4.67, -4.13, -4.58, -4.11, -4.72, -4.48, -4.0, -3.78, -3.81, -3.76, -4.23, -4.68, -4.68, -4.83, -5.02, -4.77, -5.06, -4.68, -5.05, -4.71, -4.88, -4.71, -4.85, -4.96, -5.04, -4.69, -4.95, -4.54, -4.96, -4.74, -5.01, -4.96, -4.87, -4.81, -4.94, -4.76, -4.84, -4.97, -4.85, -4.79, -5.02, -4.81, -5.01, -4.6, -4.98, -4.72, -5.02, -4.9, -4.78, -4.66, -4.48, -20.3, -55.67, -55.0, -44.35, -31.82, -27.35, -19.87, -12.05, -4.39, 2.08, 7.96, 13.92, 20.96, 27.09, 33.18, 37.0, 42.65, 47.32, 53.55, 58.38, 61.6, 64.75, 68.08, 72.06, 76.59, 80.1, 85.0, 89.5, 94.54, 99.87, 106.66, 112.41, 114.54, 118.8, 122.28, 124.79, 127.85, 129.65, 132.11, 135.56, 138.74, 145.04, 154.56, 159.86, 165.19, 169.65, 173.04, 175.73, 177.29, 177.37, 177.94, 178.26, 178.26, 178.12, 178.63, 177.48, 176.6, 176.0, 176.33, 176.1, 176.21, 176.31, 176.33, 176.15, 176.29, 176.11, 176.27, 176.12, 176.37, 176.07, 176.34, 176.2, 176.44, 175.94, 176.15, 175.66, 175.67, 176.14, 176.12, 176.21, 176.24, 176.09, 176.22, 176.07, 176.32, 176.23, 176.26, 176.21, 176.5, 176.28, 176.39, 176.16, 176.47, 176.15, 176.24, 176.1, 176.25, 176.23, 176.11, 176.04, 176.22, 176.1, 176.33, 176.12, 176.43, 176.03, 176.36, 176.28, 176.38, 176.21, 176.09, 176.39, 176.12, 176.23, 176.0, 176.08, 176.26, 176.07, 176.21, 176.23, 176.15, 176.06, 176.19, 176.07, 176.2, 176.02, 176.25, 176.17, 176.63, 176.23, 176.38, 176.2, 176.42, 176.01, 176.19, 175.83, 176.03, 175.85]

dt = 10/1000
t = np.arange(0, dt*len(r), dt)
low_pass = [1]*len(r)
low_pass1 = [1]*len(r)
n = len(r)
fft_r = fft.fft(r, n)
f = fft.fftfreq(len(r), dt)
freq = (1/(dt*n)) * np.arange(n) 
L = np.arange(1, np.floor(n/2), dtype='int')

i = 0
for val in f:
    if abs(val) >= 2:
        low_pass[i] = 0
    if abs(val)>=1.55:
        low_pass1[i] = 0
    i += 1

ind = abs(fft_r) > 1000
new = fft_r * ind

plt.figure(1)
plt.plot(f, abs(fft_r), LineWidth=2)
clean = low_pass1*fft_r
plt.plot(f, abs(new), LineWidth=1)


rNew = fft.ifft(new)
rNew1 = fft.ifft(low_pass1*fft_r)
plt.figure(2)
plt.plot(t, r, label='Unfiltered')
plt.plot(t, rNew-15, label='Ignore low power values')
plt.plot(t, rNew1, label='Low Pass 1.55Hz')
plt.legend()
plt.show()